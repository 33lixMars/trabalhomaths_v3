<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Balanço Analítico - Trabalho de Matemática 11º Inforgest</title>
</head>
<body>
    <nav class="nav-bar" aria-label="Main navigation">
        <div class="nav-inner">
            <a class="brand" href="./maths.html">Calculadora</a>
            <button class="nav-toggle" aria-expanded="false" aria-label="Open menu">
                <span class="hamburger"></span>
            </button>
            <ul class="nav-links" role="menubar">
                <li role="none"><a role="menuitem" href="maths.html">Científica</a></li>
                <li role="none"><a role="menuitem" href="financeira.html">Financeira</a></li>
                <li class="dropdown" role="none">
                    <button class="drop-btn" aria-haspopup="true" aria-expanded="false">Análise de Balanço ▾</button>
                    <ul class="dropdown-menu" role="menu">
                        <li role="none"><a role="menuitem" href="b-patrimonial.html">Balanço Patrimonial</a></li>
                        <li role="none"><a role="menuitem" href="b-sintetico.html">Balanço Sintético</a></li>
                        <li role="none"><a role="menuitem" href="b-analitico.html">Balanço Analítico</a></li>
                    </ul>
                </li>
                <li class="dropdown" role="none">
                    <button class="drop-btn" aria-haspopup="true" aria-expanded="false">Sucessões ▾</button>
                    <ul class="dropdown-menu" role="menu">
                        <li role="none"><a role="menuitem" href="s-geometrica.html">Geométrica (PG)</a></li>
                        <li role="none"><a role="menuitem" href="s-aritmetica.html">Aritmética (PA)</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </nav>

    <div class="balanco-container">
        <h2 class="balanco-title"> Balanço Analítico</h2>
        <p style="text-align: center; color: #666; margin-bottom: 30px;">Análise detalhada com todas as contas</p>
        
        <div class="balanco-grid">
            <div class="balanco-section">
                <h3>ATIVO</h3>
                <div id="ativoInputs">
                    <div class="input-row">
                        <input type="text" class="ativo-desc" placeholder="Descrição da Conta" value="Caixa">
                        <input type="number" class="ativo-val" placeholder="Valor (Kz)">
                    </div>
                </div>
                <button class="btn-add" onclick="addAtivo()">+ Adicionar Conta do Ativo</button>
            </div>

            <div class="balanco-section">
                <h3>PASSIVO</h3>
                <div id="passivoInputs">
                    <div class="input-row">
                        <input type="text" class="passivo-desc" placeholder="Descrição da Conta" value="Fornecedores">
                        <input type="number" class="passivo-val" placeholder="Valor (Kz)">
                    </div>
                </div>
                <button class="btn-add" onclick="addPassivo()">+ Adicionar Conta do Passivo</button>
            </div>
        </div>

        <div class="balanco-section" style="margin-top: 30px;">
            <h3>CAPITAL PRÓPRIO</h3>
            <div id="capitalInputs">
                <div class="input-row">
                    <input type="text" class="capital-desc" placeholder="Descrição" value="Capital Social">
                    <input type="number" class="capital-val" placeholder="Valor (Kz)">
                </div>
            </div>
            <button class="btn-add" onclick="addCapital()">+ Adicionar Conta de Capital</button>
        </div>

        <button class="btn-calcular" onclick="gerarBalancoAnalitico()">Gerar Balanço Analítico</button>
        
        <div id="resultBalanco" class="balanco-result"></div>
    </div>

    <footer>&copy; 2025-26 Grupo Nº1 Inforgest - Trabalho de Matemática</footer>

    <script src="nav.js"></script>
    <script>
        function formatarMoeda(valor) {
            return valor.toLocaleString('pt-AO', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        function addAtivo() {
            const container = document.getElementById('ativoInputs');
            const newRow = document.createElement('div');
            newRow.className = 'input-row';
            newRow.innerHTML = `
                <input type="text" class="ativo-desc" placeholder="Descrição da Conta">
                <input type="number" class="ativo-val" placeholder="Valor (Kz)">
                <button class="btn-remove" onclick="this.parentElement.remove()">×</button>
            `;
            container.appendChild(newRow);
        }

        function addPassivo() {
            const container = document.getElementById('passivoInputs');
            const newRow = document.createElement('div');
            newRow.className = 'input-row';
            newRow.innerHTML = `
                <input type="text" class="passivo-desc" placeholder="Descrição da Conta">
                <input type="number" class="passivo-val" placeholder="Valor (Kz)">
                <button class="btn-remove" onclick="this.parentElement.remove()">×</button>
            `;
            container.appendChild(newRow);
        }

        function addCapital() {
            const container = document.getElementById('capitalInputs');
            const newRow = document.createElement('div');
            newRow.className = 'input-row';
            newRow.innerHTML = `
                <input type="text" class="capital-desc" placeholder="Descrição">
                <input type="number" class="capital-val" placeholder="Valor (Kz)">
                <button class="btn-remove" onclick="this.parentElement.remove()">×</button>
            `;
            container.appendChild(newRow);
        }

        function gerarBalancoAnalitico() {
            // Coletar Ativos
            const ativosDesc = document.querySelectorAll('.ativo-desc');
            const ativosVal = document.querySelectorAll('.ativo-val');
            let ativos = [];
            let totalAtivo = 0;
            
            for (let i = 0; i < ativosDesc.length; i++) {
                if (ativosDesc[i].value && ativosVal[i].value) {
                    const valor = parseFloat(ativosVal[i].value);
                    ativos.push({desc: ativosDesc[i].value, valor: valor});
                    totalAtivo += valor;
                }
            }
            
            // Coletar Passivos
            const passivosDesc = document.querySelectorAll('.passivo-desc');
            const passivosVal = document.querySelectorAll('.passivo-val');
            let passivos = [];
            let totalPassivo = 0;
            
            for (let i = 0; i < passivosDesc.length; i++) {
                if (passivosDesc[i].value && passivosVal[i].value) {
                    const valor = parseFloat(passivosVal[i].value);
                    passivos.push({desc: passivosDesc[i].value, valor: valor});
                    totalPassivo += valor;
                }
            }
            
            // Coletar Capital Próprio
            const capitalDesc = document.querySelectorAll('.capital-desc');
            const capitalVal = document.querySelectorAll('.capital-val');
            let capital = [];
            let totalCapital = 0;
            
            for (let i = 0; i < capitalDesc.length; i++) {
                if (capitalDesc[i].value && capitalVal[i].value) {
                    const valor = parseFloat(capitalVal[i].value);
                    capital.push({desc: capitalDesc[i].value, valor: valor});
                    totalCapital += valor;
                }
            }
            
            const totalCPPassivo = totalPassivo + totalCapital;
            const diferenca = totalAtivo - totalCPPassivo;
            
            let resultHTML = `
                <h3 style="text-align: center; color: #667eea; margin-bottom: 20px;">BALANÇO ANALÍTICO</h3>
                <p style="text-align: center; color: #666; margin-bottom: 30px;">Demonstração detalhada de todas as contas</p>
                
                <table class="balanco-table">
                    <thead>
                        <tr>
                            <th colspan="2">ATIVO</th>
                            <th colspan="2">PASSIVO + CAPITAL PRÓPRIO</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${Math.max(ativos.length, passivos.length + capital.length) > 0 ? 
                            Array.from({length: Math.max(ativos.length, passivos.length + capital.length)}).map((_, i) => {
                                const ativo = ativos[i];
                                const passivo = passivos[i];
                                const cap = i >= passivos.length ? capital[i - passivos.length] : null;
                                
                                let html = '<tr>';
                                
                                // Coluna Ativo
                                if (ativo) {
                                    html += `<td>${ativo.desc}</td><td style="text-align: right;">${formatarMoeda(ativo.valor)} Kz</td>`;
                                } else {
                                    html += '<td></td><td></td>';
                                }
                                
                                // Coluna Passivo/Capital
                                if (passivo) {
                                    html += `<td>${passivo.desc}</td><td style="text-align: right;">${formatarMoeda(passivo.valor)} Kz</td>`;
                                } else if (cap) {
                                    html += `<td>${cap.desc}</td><td style="text-align: right;">${formatarMoeda(cap.valor)} Kz</td>`;
                                } else {
                                    html += '<td></td><td></td>';
                                }
                                
                                html += '</tr>';
                                return html;
                            }).join('') 
                            : '<tr><td colspan="4" style="text-align: center; color: #999;">Sem dados inseridos</td></tr>'
                        }
                        <tr class="total-row" style="background: #667eea; color: white;">
                            <td><strong>TOTAL ATIVO</strong></td>
                            <td style="text-align: right;"><strong>${formatarMoeda(totalAtivo)} Kz</strong></td>
                            <td><strong>TOTAL PASSIVO + CP</strong></td>
                            <td style="text-align: right;"><strong>${formatarMoeda(totalCPPassivo)} Kz</strong></td>
                        </tr>
                    </tbody>
                </table>
                
                ${diferenca !== 0 ? 
                    `<p style="color: #dc3545; margin-top: 20px; text-align: center; font-weight: 600; font-size: 18px;">
                        ⚠️ ATENÇÃO: Diferença de ${formatarMoeda(Math.abs(diferenca))} Kz<br>
                        O balanço deve estar equilibrado!
                    </p>` : 
                    `<p style="color: #28a745; margin-top: 20px; text-align: center; font-weight: 600; font-size: 18px;">
                        ✓ BALANÇO EQUILIBRADO!
                    </p>`
                }
                
                <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">Resumo</h3>
                    <p><strong>Total de Contas do Ativo:</strong> ${ativos.length}</p>
                    <p><strong>Total de Contas do Passivo:</strong> ${passivos.length}</p>
                    <p><strong>Total de Contas do Capital Próprio:</strong> ${capital.length}</p>
                    <p><strong>Passivo:</strong> ${formatarMoeda(totalPassivo)} Kz</p>
                    <p><strong>Capital Próprio:</strong> ${formatarMoeda(totalCapital)} Kz</p>
                </div>
            `;
            
            const result = document.getElementById('resultBalanco');
            result.className = 'balanco-result show';
            result.innerHTML = resultHTML;
        }
    </script>
</body>
</html>
